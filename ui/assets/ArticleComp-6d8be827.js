import{w as A}from"./writterController-e3593072.js";import{_ as w,v as I,R as L,I as x,r as o,o as c,c as n,w as s,a as t,V as y,b as a,t as d,l as V,k as m,d as h,e as u,z as k,i as v,f as B}from"./index-53016639.js";import{L as E,B as T}from"./BookMark-f6286f8a.js";import{V as f}from"./LoadingAndErrorSc-0b5c7d18.js";const b={name:"ArticleComp",props:["article","isEditable"],data:()=>({isLoading:!1,isAuth:!1,error:!1,msg:null,show:!1,comm:!1,like:!1,newComment:null}),mounted(){this.article.comments=[],this.isAuth=this.$store.getters.isAuth},computed:{comments(){return this.article.comments?this.article.comments:[]}},methods:{shareArticle:function(){navigator.share?navigator.share({title:this.article.title,text:this.article.shortContent,url:this.$router.currentRoute+"/"+this.article.Id}).then(()=>console.log("Shared successfully","/articlePage/"+this.article.Id)).catch(i=>console.error("Error sharing:",i)):console.log("Web Share API not supported")},markArticle:async function(){if(this.isAuth){this.error=!1,this.msg=null;const i=await I.addBookMark(this.$props.article.Id);if(i.state)if(this.like)if(this.like.like===isLike){const r=this.likes.filter(e=>e.Id!==this.like.Id);this.likes=r,this.like=null}else{this.like.like=isLike;const r=this.articleLikes.map(e=>e.Id===this.like.Id?this.like:e);this.likes=r}else this.like=i.articleLike,this.articleLikes.push(this.like);else this.msg=i.message,this.error=!0,setTimeout(()=>{this.error=!1,this.msg=null},2e3)}else this.$router.push({name:"LogIn"})},deleteArticle:async function(){this.isLoading=!0,this.error=!1,this.msg=null;const i=await A.deleteArticle(this.article.Id);this.isLoading=!1,this.error=!i.state,this.msg=i.message,setTimeout(()=>{this.msg=null,this.error=!1},2e3),i.state&&this.$emit("onArticleDeleted",this.article.Id)},goToEditArticleForm:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticleForm",query:{isEdit:!0}})},goToArticlePage:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticlePage",params:{id:this.article.Id}})}},components:{LikeComp:E,ResMsg:L,ImageComp:x,BookMark:T}};function M(i,r,e,S,P,l){const g=o("res-msg"),p=o("image-comp"),_=o("BookMark"),C=o("like-comp");return c(),n(B,{class:"ma-2 pa-2"},{default:s(()=>[t(u,null,{default:s(()=>[t(y,null,{default:s(()=>[a(d(e.article.title),1)]),_:1}),t(V),e.isEditable?(c(),n(m,{key:0,variant:"text",color:"orange","prepend-icon":"mdi-note-edit",onClick:l.goToEditArticleForm},{default:s(()=>[a(" Edit ")]),_:1},8,["onClick"])):h("",!0),e.isEditable?(c(),n(m,{key:1,onClick:l.deleteArticle,loading:i.isLoading,variant:"text",color:"red","prepend-icon":"mdi-note-remove"},{default:s(()=>[a(" Delete ")]),_:1},8,["onClick","loading"])):h("",!0)]),_:1}),t(g,{msg:i.msg,error:i.error},null,8,["msg","error"]),e.article.writter?(c(),n(k,{key:0},{default:s(()=>[a(" Writter: "+d(e.article.writter.name),1)]),_:1})):h("",!0),t(k,null,{default:s(()=>[a(d(e.article.updatedAt),1)]),_:1}),t(u,null,{default:s(()=>[t(f,null,{default:s(()=>[t(v,null,{default:s(()=>[a(d(e.article.shortContent),1)]),_:1})]),_:1}),t(f,null,{default:s(()=>[t(p,{src:"/api/"+e.article.image,alt:e.article.title,mx_h:"300px",mx_w:"300px",mi_w:"200px"},null,8,["src","alt"])]),_:1})]),_:1}),t(u,{class:"my-4"},{default:s(()=>[t(m,{variant:"text",onClick:l.goToArticlePage,size:"small",color:"secondary",class:"ml-2","append-icon":i.show?"mdi-chevron-up":"mdi-gesture-tap"},{default:s(()=>[a("Explore ")]),_:1},8,["onClick","append-icon"]),t(m,{"append-icon":"mdi-share-variant",variant:"text",color:"secondary",class:"ml-2",onClick:l.shareArticle,size:"small"},{default:s(()=>[a(" Share ")]),_:1},8,["onClick"]),t(_,{"user-book-marks":e.article.userBookMarks,"article-id":e.article.Id},null,8,["user-book-marks","article-id"]),t(C,{"article-likes":e.article.articleLikes,"article-id":e.article.Id},null,8,["article-likes","article-id"])]),_:1})]),_:1})}const N=w(b,[["render",M]]);export{N as A};
