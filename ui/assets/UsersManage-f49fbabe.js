import{a as V}from"./adminController-a0b4df7b.js";import{L as w}from"./LoadingAndErrorSc-511b65a8.js";import{W}from"./WritterComp-1a87295b.js";import{_ as T,R as D,r as S,o as u,g as h,a as t,w as r,V as R,b as a,t as i,z as I,ah as c,m as L,k as _,bJ as A,ai as E,aj as B,B as M,e as b,c as f,i as U,d as C,j as y,f as x,F as g,n as k}from"./index-05bb36e0.js";import{V as O,a as j,b as F,c as P}from"./VTabs-add0c9c4.js";import{V as q}from"./VVirtualScroll-b6768b0b.js";import"./lazy-92e6129b.js";import"./VSlideGroup-2d0c8011.js";import"./getScrollParent-6bb6c202.js";const z={name:"UserComp",components:{ResMsg:D},props:["user"],emits:["onDelete","onStop"],data(){return{show:!1,loading:!1,error:!1,msg:null,uNotification:null}},methods:{userIsStopedToggel:async function(){this.loading=!0,this.error=!1,this.msg=null;const e={Id:this.user.Id,isStoped:!this.user.isStoped};this.uNotification&&(e.notification=this.uNotification);const s=await V.updateUser(e);this.loading=!1,this.error=!s.state,this.msg=s.message,s.state&&(this.user.isStoped=!this.user.isStoped,this.$emit("onStop",this.user)),setTimeout(()=>{this.msg=null},1e3)},deleteUser:async function(){this.loading=!0,this.error=!1,this.msg=null;const e=await V.deleteUser(this.user.Id);this.loading=!1,this.error=!e.state,this.msg=e.message,e.state&&this.$emit("onDelete",this.user.Id),setTimeout(()=>{this.msg=null},1e3)}}},J=c("strong",null,"Email: ",-1),G=c("strong",null,"Phone: ",-1);function H(e,s,o,N,l,d){const p=S("ResMsg");return u(),h(g,null,[t(p,{msg:l.msg,error:l.error},null,8,["msg","error"]),t(x,{class:"ma-2 pa-4"},{default:r(()=>[t(R,null,{default:r(()=>[a(i(o.user.name),1)]),_:1}),t(I,null,{default:r(()=>[a(" Registered At: "),c("strong",null,i(new Date(o.user.createdAt).toLocaleString()),1)]),_:1}),t(I,null,{default:r(()=>[a(" Last Update At: "),c("strong",null,i(new Date(o.user.createdAt).toLocaleString()),1)]),_:1}),t(L,null,{default:r(()=>[t(_,{onClick:s[0]||(s[0]=m=>l.show=!l.show),color:"green"},{default:r(()=>[a(" Show Detials ")]),_:1})]),_:1}),t(A,null,{default:r(()=>[E(c("div",null,[t(M),t(b,null,{default:r(()=>[o.user.email?(u(),f(U,{key:0},{default:r(()=>[J,a(" "+i(o.user.email)+" ",1),c("strong",null," - "+i(o.user.isEmailVerified?"Verified":"Not Verified"),1)]),_:1})):C("",!0),o.user.phone?(u(),f(U,{key:1},{default:r(()=>[G,a(" "+i(o.user.phone)+" ",1),c("strong",null," - "+i(o.user.isPVerified?"Verified":"Not Verified"),1)]),_:1})):C("",!0)]),_:1}),t(L,null,{default:r(()=>[t(y,{modelValue:l.uNotification,"onUpdate:modelValue":s[1]||(s[1]=m=>l.uNotification=m),color:"primary",label:"Send Notification",variant:"underlined"},null,8,["modelValue"]),t(_,{onClick:d.userIsStopedToggel,color:"red"},{default:r(()=>[a(i(o.user.isStoped?"UnStop User":"Stop User"),1)]),_:1},8,["onClick"])]),_:1})],512),[[B,l.show]])]),_:1})]),_:1})],64)}const K=T(z,[["render",H]]),Q={components:{LoadingAndErrorSc:w,WritterComp:W,UserComp:K},data(){return{currentWindow:"newWrittersRequests",currentIndex:0,sVal:null,windows:[{index:0,title:"Users",value:"users",isStoped:!1,count:0,page:0,users:[],fUsers:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null},{index:1,title:"Stoped Users",value:"stopedUsers",isStoped:!0,count:0,page:0,users:[],fUsers:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null}]}},async mounted(){await this.onTab(this.windows[0])},methods:{onTab:async function(e){this.currentWindow=e.value,this.currentIndex=e.index,e.users.length||await this.loadUsers(e)},contains:function(e,s){return e?e.includes(s):!1},onSChange:function(){this.sVal&&(this.windows[this.currentIndex].msg=null,this.windows[this.currentIndex].fUsers=this.windows[this.currentIndex].users.filter(e=>this.sVal.includes("@")?this.contains(e.email,this.sVal):this.contains(e.name.toLowerCase(),this.sVal.toLowerCase())||this.contains(e.phone,this.sVal)))},onSearch:async function(){if(this.sVal){const e=this.windows[this.currentIndex];e.loading=!0,e.error=!1,e.msg=null,e.page=0;const s=await V.usersSearch(this.sVal,e.page,e.isStoped);e.loading=!1,console.log(s),s.state?s.count?(e.fUsers=s.users,e.count=s.count,e.isLoaded=!0):e.msg="There Is No Users":(e.msg=s.message,e.error=!0)}},updateUser:function(e){this.deleteUser(e.Id),e.isStoped?this.windows[1].isLoaded&&(this.windows[1].users.push(e),this.windows[1].count++):this.windows[0].isLoaded&&(this.windows[0].users.push(e),this.windows[0].count++)},deleteUser:function(e){const s=this.windows[this.currentIndex].users.filter(o=>o.Id!==e);this.windows[this.currentIndex].users=s,this.windows[this.currentIndex].count--},loadUsers:async function(e){e.loading=!0,e.error=!1,e.msg=null;const s=await V.getUsers(e.page,e.isStoped);e.loading=!1,s.state?s.count?(e.users.push(...s.users),e.count=s.count,e.page++,e.isLoaded=!0):e.msg="There Is No Users":(e.msg=s.message,e.error=!0)}}};function X(e,s,o,N,l,d){const p=S("LoadingAndErrorSc"),m=S("UserComp");return u(),h(g,null,[t(O,{modelValue:l.currentWindow,"onUpdate:modelValue":s[0]||(s[0]=n=>l.currentWindow=n),"fixed-tabs":""},{default:r(()=>[(u(!0),h(g,null,k(l.windows,n=>(u(),f(F,{key:n.value,value:n.value,onClick:v=>d.onTab(n)},{default:r(()=>[a(i(n.title)+" "+i(n.count),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"]),e.$store.getters.isSearch?(u(),f(x,{key:0,class:"ma-2 pa-2"},{default:r(()=>[t(U,null,{default:r(()=>[t(b,{justify:"center"},{default:r(()=>[t(y,{modelValue:l.sVal,"onUpdate:modelValue":[s[1]||(s[1]=n=>l.sVal=n),d.onSChange],color:"blue",label:"Search",variant:"underlined",clearable:!0},null,8,["modelValue","onUpdate:modelValue"]),t(_,{onClick:d.onSearch,color:"blue",class:"ma-3"},{default:r(()=>[a("Search")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})):C("",!0),t(j,{modelValue:l.currentWindow,"onUpdate:modelValue":s[2]||(s[2]=n=>l.currentWindow=n)},{default:r(()=>[(u(!0),h(g,null,k(l.windows,n=>(u(),f(P,{key:n.value,value:n.value},{default:r(()=>[t(p,{isLoading:n.loading,msg:n.msg,error:n.error},null,8,["isLoading","msg","error"]),t(x,{flat:""},{default:r(()=>[t(q,{ref_for:!0,ref:n.scrollRef,items:l.sVal?n.fUsers:n.users,height:"700","item-height":"70"},{default:r(({item:v})=>[t(m,{user:v,onOnStop:d.updateUser,onOnDelete:d.deleteUser},null,8,["user","onOnStop","onOnDelete"])]),_:2},1032,["items"])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)}const oe=T(Q,[["render",X]]);export{oe as default};
