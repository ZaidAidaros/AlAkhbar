import{w as A}from"./writterController-c2d3a554.js";import{_ as w,u as I,R as L,r as o,o as c,c as n,w as s,a as t,V as x,b as r,t as m,y,i as d,d as h,e as u,z as k,j as V,f as v}from"./index-f94e1acf.js";import{L as B,B as E}from"./BookMark-6a9551d2.js";import{I as T}from"./ImageComp-12493afd.js";import{V as f}from"./LoadingAndErrorSc-661e382d.js";const b={name:"ArticleComp",props:["article","isEditable"],data:()=>({isLoading:!1,isAuth:!1,error:!1,msg:null,show:!1,comm:!1,like:!1,newComment:null}),mounted(){this.article.comments=[],this.isAuth=this.$store.getters.isAuth},computed:{comments(){return this.article.comments?this.article.comments:[]}},methods:{shareArticle:function(){navigator.share?navigator.share({title:this.article.title,text:this.article.shortContent,url:this.$router.currentRoute+"/"+this.article.Id}).then(()=>console.log("Shared successfully","/articlePage/"+this.article.Id)).catch(i=>console.error("Error sharing:",i)):console.log("Web Share API not supported")},markArticle:async function(){if(this.isAuth){this.error=!1,this.msg=null;const i=await I.addBookMark(this.$props.article.Id);if(i.state)if(this.like)if(this.like.like===isLike){const a=this.likes.filter(e=>e.Id!==this.like.Id);this.likes=a,this.like=null}else{this.like.like=isLike;const a=this.articleLikes.map(e=>e.Id===this.like.Id?this.like:e);this.likes=a}else this.like=i.articleLike,this.articleLikes.push(this.like);else this.msg=i.message,this.error=!0,setTimeout(()=>{this.error=!1,this.msg=null},2e3)}else this.$router.push({name:"LogIn"})},deleteArticle:async function(){this.isLoading=!0,this.error=!1,this.msg=null;const i=await A.deleteArticle(this.article.Id);this.isLoading=!1,this.error=!i.state,this.msg=i.message,setTimeout(()=>{this.msg=null,this.error=!1},2e3),i.state&&this.$emit("onArticleDeleted",this.article.Id)},goToEditArticleForm:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticleForm",query:{isEdit:!0}})},goToArticlePage:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticlePage",params:{id:this.article.Id}})}},components:{LikeComp:B,ResMsg:L,ImageComp:T,BookMark:E}};function M(i,a,e,S,P,l){const g=o("res-msg"),p=o("image-comp"),_=o("BookMark"),C=o("like-comp");return c(),n(v,{class:"ma-2 pa-2"},{default:s(()=>[t(u,null,{default:s(()=>[t(x,null,{default:s(()=>[r(m(e.article.title),1)]),_:1}),t(y),e.isEditable?(c(),n(d,{key:0,variant:"text",color:"orange","prepend-icon":"mdi-note-edit",onClick:l.goToEditArticleForm},{default:s(()=>[r(" Edit ")]),_:1},8,["onClick"])):h("",!0),e.isEditable?(c(),n(d,{key:1,onClick:l.deleteArticle,loading:i.isLoading,variant:"text",color:"red","prepend-icon":"mdi-note-remove"},{default:s(()=>[r(" Delete ")]),_:1},8,["onClick","loading"])):h("",!0)]),_:1}),t(g,{msg:i.msg,error:i.error},null,8,["msg","error"]),e.article.writter?(c(),n(k,{key:0},{default:s(()=>[r(" Writter: "+m(e.article.writter.name),1)]),_:1})):h("",!0),t(k,null,{default:s(()=>[r(m(e.article.updatedAt),1)]),_:1}),t(u,null,{default:s(()=>[t(f,null,{default:s(()=>[t(V,null,{default:s(()=>[r(m(e.article.shortContent),1)]),_:1})]),_:1}),t(f,null,{default:s(()=>[t(p,{src:"/api/"+e.article.image,alt:e.article.title,mx_h:"300px",mx_w:"300px",mi_w:"200px"},null,8,["src","alt"])]),_:1})]),_:1}),t(u,{class:"my-4 mx-2"},{default:s(()=>[t(d,{variant:"text",onClick:l.goToArticlePage,size:"small",color:"secondary",class:"ml-2","append-icon":i.show?"mdi-chevron-up":"mdi-gesture-tap"},{default:s(()=>[r("Explore ")]),_:1},8,["onClick","append-icon"]),t(d,{"append-icon":"mdi-share-variant",variant:"text",color:"secondary",class:"ml-2 mb-2",onClick:l.shareArticle,size:"small"},{default:s(()=>[r(" Share ")]),_:1},8,["onClick"]),t(_,{"user-book-marks":e.article.userBookMarks,"article-id":e.article.Id},null,8,["user-book-marks","article-id"]),t(C,{"article-likes":e.article.articleLikes,"article-id":e.article.Id},null,8,["article-likes","article-id"])]),_:1})]),_:1})}const W=w(b,[["render",M]]);export{W as A};
