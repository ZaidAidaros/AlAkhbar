import{w as x,V as E}from"./VMenu-7d4fa078.js";import{_ as v,R as M,u as T,r as h,o as r,c as a,w as i,a as t,V as B,b as o,t as c,y as f,i as k,m as S,p,k as g,l as _,F as C,e as m,z as A,d as P,j as F,f as b,q as I}from"./index-8f605de4.js";import{L as D,B as R}from"./BookMark-1d934297.js";import{I as N}from"./ImageComp-e204e100.js";import{V as L}from"./LoadingAndErrorSc-cdfdb646.js";const q={name:"ArticleComp",props:["article","isEditable"],components:{LikeComp:D,ResMsg:M,ImageComp:N,BookMark:R},data:()=>({isLoading:!1,isAuth:!1,error:!1,msg:null,show:!1,comm:!1,like:!1,newComment:null,menuItemsM:[{title:"Edit",icon:"mdi-note-edit",color:"orange"},{title:"Delete",icon:"mdi-note-remove",color:"red"}],menuItems:[{title:"Share",icon:"mdi-share-variant",color:"secondary"}]}),mounted(){this.article.comments=[],this.isAuth=this.$store.getters.isAuth},computed:{comments(){return this.article.comments?this.article.comments:[]}},methods:{onClickMenuItem:function(e){e.title==="Edit"?this.goToEditArticleForm():e.title==="Delete"?this.deleteArticle():e.title==="Share"&&this.shareArticle()},shareArticle:function(){navigator.share?navigator.share({title:this.article.title,text:this.article.shortContent,url:this.$router.currentRoute+"/"+this.article.Id}).then(()=>console.log("Shared successfully","/articlePage/"+this.article.Id)).catch(e=>console.error("Error sharing:",e)):console.log("Web Share API not supported")},markArticle:async function(){if(this.isAuth){this.error=!1,this.msg=null;const e=await T.addBookMark(this.$props.article.Id);if(e.state)if(this.like)if(this.like.like===isLike){const n=this.likes.filter(l=>l.Id!==this.like.Id);this.likes=n,this.like=null}else{this.like.like=isLike;const n=this.articleLikes.map(l=>l.Id===this.like.Id?this.like:l);this.likes=n}else this.like=e.articleLike,this.articleLikes.push(this.like);else this.msg=e.message,this.error=!0,setTimeout(()=>{this.error=!1,this.msg=null},2e3)}else this.$router.push({name:"LogIn"})},deleteArticle:async function(){this.isLoading=!0,this.error=!1,this.msg=null;const e=await x.deleteArticle(this.article.Id);this.isLoading=!1,this.error=!e.state,this.msg=e.message,setTimeout(()=>{this.msg=null,this.error=!1},2e3),e.state&&this.$emit("onArticleDeleted",this.article.Id)},goToEditArticleForm:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticleForm",query:{isEdit:!0}})},goToArticlePage:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticlePage",params:{id:this.article.Id}})}}};function z(e,n,l,W,j,u){const V=h("res-msg"),w=h("image-comp"),y=h("like-comp");return r(),a(b,{class:"ma-2 pa-2"},{default:i(()=>[t(m,null,{default:i(()=>[t(B,null,{default:i(()=>[o(c(l.article.title),1)]),_:1}),t(f),t(E,null,{activator:i(({props:s})=>[t(k,S({icon:"mdi-dots-vertical"},s,{flat:"",class:"ma-2"}),null,16)]),default:i(()=>[l.isEditable?(r(),a(p,{key:0},{default:i(()=>[(r(!0),g(C,null,_(e.menuItemsM,(s,d)=>(r(),a(I,{key:d,title:s.title,"append-icon":s.icon,color:s.color,onClick:()=>{u.onClickMenuItem(s)}},null,8,["title","append-icon","color","onClick"]))),128))]),_:1})):(r(),a(p,{key:1},{default:i(()=>[(r(!0),g(C,null,_(e.menuItems,(s,d)=>(r(),a(I,{key:d,title:s.title,"append-icon":s.icon,color:s.color,onClick:()=>{u.onClickMenuItem(s)}},null,8,["title","append-icon","color","onClick"]))),128))]),_:1}))]),_:1})]),_:1}),t(m,null,{default:i(()=>[t(f)]),_:1}),t(V,{msg:e.msg,error:e.error},null,8,["msg","error"]),l.article.writter?(r(),a(A,{key:0},{default:i(()=>[o(" Writter: "+c(l.article.writter.name),1)]),_:1})):P("",!0),t(A,null,{default:i(()=>[o(c(l.article.updatedAt),1)]),_:1}),t(m,null,{default:i(()=>[t(L,null,{default:i(()=>[t(F,null,{default:i(()=>[o(c(l.article.shortContent),1)]),_:1})]),_:1}),t(L,null,{default:i(()=>[t(w,{src:l.article.image,alt:l.article.title,mx_h:"300px",mx_w:"300px",mi_w:"200px"},null,8,["src","alt"])]),_:1})]),_:1}),t(m,{class:"my-4 mx-2"},{default:i(()=>[t(k,{variant:"text",onClick:u.goToArticlePage,size:"small",color:"secondary",class:"ml-2","append-icon":e.show?"mdi-chevron-up":"mdi-gesture-tap"},{default:i(()=>[o("Explore ")]),_:1},8,["onClick","append-icon"]),t(f),t(y,{"article-likes":l.article.articleLikes,"article-id":l.article.Id},null,8,["article-likes","article-id"])]),_:1})]),_:1})}const Q=v(q,[["render",z]]);export{Q as A};
