import{w as S,V}from"./VMenu-c6c19cc5.js";import{_ as y,R as b,u as B,r as h,o as a,c as r,w as i,a as t,V as M,b as o,t as n,z as f,g as p,n as F,q as k,l as _,m as g,F as A,A as I,d as T,i as C,j as D,e as R,s as E}from"./index-655d32d5.js";import{L as x,B as N}from"./BookMark-552bf4fc.js";import{I as v}from"./ImageComp-8c71b5ba.js";import{V as m}from"./VRow-bb3aae33.js";const O={name:"ArticleComp",props:["article","isEditable"],components:{LikeComp:x,ResMsg:b,ImageComp:v,BookMark:N},data:()=>({isLoading:!1,isAuth:!1,error:!1,msg:null,show:!1,comm:!1,like:!1,newComment:null,menuItemsM:[{title:"Edit",icon:"mdi-note-edit",color:"orange"},{title:"Delete",icon:"mdi-note-remove",color:"red"}],menuItems:[{title:"Share",icon:"mdi-share-variant",color:"secondary"}]}),mounted(){this.article.comments=[],this.isAuth=this.$store.getters.isAuth},computed:{comments(){return this.article.comments?this.article.comments:[]}},methods:{onClickMenuItem:function(e){e.title==="Edit"?this.goToEditArticleForm():e.title==="Delete"?this.deleteArticle():e.title==="Share"&&this.shareArticle()},shareArticle:function(){navigator.share?navigator.share({title:this.article.title,text:this.article.shortContent,url:"http://localhost:3000/articlePage/"+this.article.Id}).then(()=>console.log("Shared successfully","/articlePage/"+this.article.Id)).catch(e=>console.error("Error sharing:",e)):console.log("Web Share API not supported")},markArticle:async function(){if(this.isAuth){this.error=!1,this.msg=null;const e=await B.addBookMark(this.$props.article.Id);if(e.state)if(this.like)if(this.like.like===isLike){const c=this.likes.filter(l=>l.Id!==this.like.Id);this.likes=c,this.like=null}else{this.like.like=isLike;const c=this.articleLikes.map(l=>l.Id===this.like.Id?this.like:l);this.likes=c}else this.like=e.articleLike,this.articleLikes.push(this.like);else this.msg=e.message,this.error=!0,setTimeout(()=>{this.error=!1,this.msg=null},2e3)}else this.$router.push({name:"LogIn"})},deleteArticle:async function(){this.isLoading=!0,this.error=!1,this.msg=null;const e=await S.deleteArticle(this.article.Id);this.isLoading=!1,this.error=!e.state,this.msg=e.message,setTimeout(()=>{this.msg=null,this.error=!1},2e3),e.state&&this.$emit("onArticleDeleted",this.article.Id)},goToEditArticleForm:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticleForm",query:{isEdit:!0}})},goToArticlePage:async function(){await this.$store.dispatch("setArticle",this.article),this.$router.push({name:"ArticlePage",params:{id:this.article.Id}})}}};function U(e,c,l,K,q,u){const w=h("res-msg"),L=h("image-comp"),P=h("like-comp");return a(),r(R,{class:"ma-2 pa-2"},{default:i(()=>[t(m,null,{default:i(()=>[t(M,null,{default:i(()=>[o(n(l.article.title),1)]),_:1}),t(f),t(V,null,{activator:i(({props:s})=>[t(p,F({icon:"mdi-dots-vertical"},s,{flat:"",class:"ma-2"}),null,16)]),default:i(()=>[l.isEditable?(a(),r(k,{key:0},{default:i(()=>[(a(!0),_(A,null,g(e.menuItemsM,(s,d)=>(a(),r(E,{key:d,title:s.title,"append-icon":s.icon,color:s.color,onClick:()=>{u.onClickMenuItem(s)}},null,8,["title","append-icon","color","onClick"]))),128))]),_:1})):(a(),r(k,{key:1},{default:i(()=>[(a(!0),_(A,null,g(e.menuItems,(s,d)=>(a(),r(E,{key:d,title:s.title,"append-icon":s.icon,color:s.color,onClick:()=>{u.onClickMenuItem(s)}},null,8,["title","append-icon","color","onClick"]))),128))]),_:1}))]),_:1})]),_:1}),t(m,null,{default:i(()=>[t(f)]),_:1}),t(w,{msg:e.msg,error:e.error},null,8,["msg","error"]),l.article.writter?(a(),r(I,{key:0},{default:i(()=>[o(" Writter: "+n(l.article.writter.name),1)]),_:1})):T("",!0),t(I,null,{default:i(()=>[o(n(l.article.updatedAt),1)]),_:1}),t(m,null,{default:i(()=>[t(C,null,{default:i(()=>[t(D,null,{default:i(()=>[o(n(l.article.shortContent),1)]),_:1})]),_:1}),t(C,null,{default:i(()=>[t(L,{src:l.article.image,alt:l.article.title,mx_h:"300px",mx_w:"300px",mi_w:"200px"},null,8,["src","alt"])]),_:1})]),_:1}),t(m,{class:"my-4 mx-2"},{default:i(()=>[t(p,{variant:"text",onClick:u.goToArticlePage,size:"small",color:"secondary",class:"ml-2","append-icon":e.show?"mdi-chevron-up":"mdi-gesture-tap"},{default:i(()=>[o("Explore ")]),_:1},8,["onClick","append-icon"]),t(f),t(P,{"article-likes":l.article.articleLikes,"article-id":l.article.Id},null,8,["article-likes","article-id"])]),_:1})]),_:1})}const H=y(O,[["render",U]]);export{H as A};
