import{a as h}from"./adminController-2af355f6.js";import{L as x}from"./LoadingAndErrorSc-d526a2a3.js";import{W as S}from"./WritterComp-3e206920.js";import{_ as I,l as u,a as r,w as i,c as d,e as m,d as T,F as c,r as p,o as a,m as g,f as L,g as _,b as V,j as C,t as w}from"./index-9ba368a2.js";import{V as A,a as b,b as N,c as k}from"./VTabs-3a4bf582.js";import{V as R}from"./VRow-41e0a699.js";import{V as y}from"./VVirtualScroll-d2e4c9be.js";import"./lazy-31b61e80.js";import"./VSlideGroup-bb97b029.js";import"./getScrollParent-6bb6c202.js";const O={components:{LoadingAndErrorSc:x,WritterComp:S},data(){return{currentWindow:"newWritersRequests",currentIndex:0,sVal:null,windows:[{index:0,enTitle:"Writers",arTitle:"الكُتّاب",value:"writters",isApproved:!0,isStoped:!1,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null},{index:1,enTitle:"New Requests",arTitle:"طلبات جديده",value:"newWritersRequests",isApproved:null,isStoped:!1,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null},{index:2,enTitle:"Stoped Writers",arTitle:"كُتّاب موقوفون",value:"approvedWriters",isApproved:!0,isStoped:!0,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null},{index:3,enTitle:"Rejected Requests",arTitle:"طلبات مرفوظه",value:"rejectedWriters",isApproved:!1,isStoped:!1,count:0,page:0,writters:[],fWritters:[],loading:!0,isLoaded:!1,error:!1,msg:null,scrollRef:null}]}},async mounted(){await this.onTab(this.windows[0])},methods:{onTab:async function(e){this.currentWindow=e.value,this.currentIndex=e.index,e.isLoaded||await this.loadWritters(e)},contains:function(e,t){return e?e.includes(t):!1},onSChange:function(){this.sVal&&(this.windows[this.currentIndex].msg=null,this.windows[this.currentIndex].fWritters=this.windows[this.currentIndex].writters.filter(e=>this.contains(e.firstName,this.sVal)||this.contains(e.middelName,this.sVal)||this.contains(e.lastName,this.sVal)||this.contains(e.familyName,this.sVal)||this.contains(e.nickName,this.sVal)||this.contains(e.fullName,this.sVal)||this.contains(e.nic,this.sVal)||this.contains(e.address,this.sVal)))},onSearch:async function(){if(this.sVal){const e=this.windows[this.currentIndex];e.loading=!0,e.error=!1,e.msg=null,e.page=0;const t=await h.writtersSearch(this.sVal,e.page,e.isApproved,e.isStoped);e.loading=!1,t.state?t.writters.length?(e.fWritters=t.writters,e.page++,e.isLoaded=!0,t.count&&(e.count=t.count)):e.msg="There Is No Writters":(e.msg=t.message,e.error=!0)}},onApprove:function(e){const t=this.windows[this.currentIndex].writters.filter(o=>o.Id!==e.Id);this.windows[this.currentIndex].writters=t,this.windows[this.currentIndex].count--,e.isApproved?this.windows[1].isLoaded&&(this.windows[1].writters.push(e),this.windows[1].count++):this.windows[3].isLoaded&&(this.windows[3].writters.push(e),this.windows[3].count++)},onStop:function(e){console.log(e);const t=this.windows[this.currentIndex].writters.filter(o=>o.Id!==e.Id);this.windows[this.currentIndex].writters=t,this.windows[this.currentIndex].count--,e.isStoped?this.windows[2].isLoaded&&(this.windows[2].writters.push(e),this.windows[2].count++):this.windows[1].isLoaded&&(this.windows[1].writters.push(e),this.windows[1].count++)},deleteWritter:function(e){const t=this.windows[this.currentIndex].writters.filter(o=>o.Id!==e);this.windows[this.currentIndex].writters=t,this.windows[this.currentIndex].count--},loadWritters:async function(e){e.loading=!0,e.error=!1,e.msg=null;const t=await h.getWritters(e.page,e.isApproved,e.isStoped);e.loading=!1,t.state?t.writters.length?(e.writters.push(...t.writters),t.count&&(e.count=t.count),e.page++,e.isLoaded=!0):e.msg="There Is No Writters":(e.msg=t.message,e.error=!0)}}};function j(e,t,o,q,n,l){const W=p("LoadingAndErrorSc"),v=p("WritterComp");return a(),u(c,null,[r(A,{modelValue:n.currentWindow,"onUpdate:modelValue":t[0]||(t[0]=s=>n.currentWindow=s),"fixed-tabs":""},{default:i(()=>[(a(!0),u(c,null,g(n.windows,s=>(a(),d(N,{key:s.value,value:s.value,onClick:f=>l.onTab(s)},{default:i(()=>[V(w(s[e.$i18n.locale+"Title"])+" "+w(s.count),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"]),e.$store.getters.isSearch?(a(),d(m,{key:0,class:"ma-2 pa-2"},{default:i(()=>[r(C,null,{default:i(()=>[r(R,{justify:"center"},{default:i(()=>[r(L,{modelValue:n.sVal,"onUpdate:modelValue":[t[1]||(t[1]=s=>n.sVal=s),l.onSChange],color:"blue",label:"Search",variant:"underlined",clearable:!0},null,8,["modelValue","onUpdate:modelValue"]),r(_,{onClick:l.onSearch,color:"blue",class:"ma-3"},{default:i(()=>[V("Search")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})):T("",!0),r(b,{modelValue:n.currentWindow,"onUpdate:modelValue":t[2]||(t[2]=s=>n.currentWindow=s)},{default:i(()=>[(a(!0),u(c,null,g(n.windows,s=>(a(),d(k,{key:s.value,value:s.value},{default:i(()=>[r(W,{isLoading:s.loading,msg:s.msg,error:s.error},null,8,["isLoading","msg","error"]),r(m,{flat:""},{default:i(()=>[r(y,{ref_for:!0,ref:s.scrollRef,items:n.sVal?s.fWritters:s.writters,height:"700","item-height":"70"},{default:i(({item:f})=>[r(v,{writter:f,onOnApprove:l.onApprove,onOnStop:l.onStop,onOnDelete:l.deleteWritter},null,8,["writter","onOnApprove","onOnStop","onOnDelete"])]),_:2},1032,["items"])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])],64)}const K=I(O,[["render",j]]);export{K as default};
