import{_ as g,R as y,L as v,r as p,o as b,g as P,a as t,w as m,f as k,x as V,j as w,B as f,k as $,b as q}from"./index-53016639.js";import{c as C,b as R,u as I,g as T}from"./getCurrentUser-e1e6a7ca.js";import{s as B}from"./signin-84e4d9cd.js";import{l as h}from"./logout-2dcaad44.js";import{r as c}from"./authController-5028803d.js";async function E(e,s){return await C(R,s,e).then(r=>({state:!0,result:r})).catch(r=>({state:!1,result:r}))}async function F(e,s){return await I(e,s).then(r=>({state:!0,result:r})).catch(r=>({state:!1,result:r}))}const L={name:"ResetPassword",data:()=>({visible:!1,loading:!1,error:!1,msg:null,password:null,confirmPassword:null,rules:{required:e=>!!e||"Required.",password:e=>e.length>=6&&e.length<=20||"Max 20 characters , Min 6"}}),methods:{submit:async function(){if((await this.$refs.restPassForm.validate()).valid)if(this.password===this.confirmPassword){this.loading=!0,this.error=!1,this.msg=null;const s=this.$route.query.contact,r=this.$route.query.otp;if(r){let{state:n,result:i}=await E(this.password,r);if(n){let{state:o,result:d}=await B(s,this.password);if(o){const a=await d.user.getIdToken(),u=await c({newPassword:this.password,phoneEmail:s,token:a});this.loading=!1,this.error=!u.state,this.msg=u.message,u.state&&(await h(),this.msg+=`
 Wait Will Redirect You To Log In Page`,setTimeout(()=>{this.$router.push({name:"LogIn",query:{email:s}})},2e3))}}else this.error=!0,this.msg=i.message}const l=this.$route.query.idToken;if(l){let{state:n,result:i}=await F(T(),this.password);if(n){const o=await c({newPassword:this.password,phoneEmail:s,token:l});this.error=!o.state,this.msg=o.message,o.state&&(await h(),this.$router.push({name:"LogIn",query:{phone:s}}))}else this.error=!0,this.msg=i.message}this.loading=!1}else this.error=!0,this.msg="The Passwords Not Matched"}},components:{ResMsg:y,LogoComp:v}},M={class:"justify-center"};function N(e,s,r,l,n,i){const o=p("logo-comp"),d=p("res-msg");return b(),P("div",M,[t(k,{class:"mx-auto py-4 px-8",elevation:"8","max-width":"448",rounded:"lg"},{default:m(()=>[t(o,{size:"150"}),t(V,{ref:"restPassForm"},{default:m(()=>[t(w,{modelValue:e.password,"onUpdate:modelValue":s[0]||(s[0]=a=>e.password=a),rules:[e.rules.required,e.rules.password],"append-inner-icon":e.visible?"mdi-eye-off":"mdi-eye",type:e.visible?"text":"password",density:"compact",placeholder:"Enter your password","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":s[1]||(s[1]=a=>e.visible=!e.visible)},null,8,["modelValue","rules","append-inner-icon","type"]),t(w,{modelValue:e.confirmPassword,"onUpdate:modelValue":s[2]||(s[2]=a=>e.confirmPassword=a),rules:[e.rules.required,e.rules.password],"append-inner-icon":e.visible?"mdi-eye-off":"mdi-eye",type:e.visible?"text":"password",density:"compact",placeholder:"Enter your password","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","onClick:appendInner":s[3]||(s[3]=a=>e.visible=!e.visible)},null,8,["modelValue","rules","append-inner-icon","type"])]),_:1},512),t(f),t(d,{msg:e.msg,error:e.error},null,8,["msg","error"]),t(f),t($,{onClick:i.submit,loading:e.loading,block:"",class:"mb-4",color:"blue",size:"large",type:"submit",variant:"elevated"},{default:m(()=>[q(" Rest Your Password ")]),_:1},8,["onClick","loading"])]),_:1})])}const D=g(L,[["render",N]]);export{D as default};
